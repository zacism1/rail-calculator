<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ballast Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
            position: relative;
            overflow-y: auto;
        }
        .background-img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('newrail.png'); /* Replace with actual image URL or base64 */
            background-size: cover;
            opacity: 0.5;
            z-index: -1;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .quote-btn {
            background-color: orange;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
        }
        .info-btn {
            background: none;
            border: none;
            font-size: 22px;
            color: blue;
            cursor: pointer;
        }
        .input-row {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        input[type="text"] {
            flex: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-right: 10px;
            margin-bottom: 10px;
            min-width: 200px;
        }
        .calc-btn, .copy-btn, .spacing-btn {
            background-color: blue;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin-left: 10px;
            margin-bottom: 10px;
        }
        .disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .results {
            display: none;
        }
        .result-item {
            margin-bottom: 10px;
        }
        .icon {
            width: 25px;
            height: 25px;
            margin-left: 10px;
        }
        .bottom-row {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
            border-radius: 10px;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover {
            color: black;
            cursor: pointer;
        }
        .decline-btn {
            background-color: red;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .agree-btn {
            background-color: green;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="background-img"></div>
    <div class="container">
        <div class="header">
            <button class="quote-btn" onclick="showQuote()">Quote of the week</button>
            <button class="info-btn" onclick="showInfo()">ℹ️</button>
        </div>
        <div class="input-row">
            <input type="text" id="distance" placeholder="Distance of track (in meters)">
            <input type="text" id="depth" value="300" placeholder="Ballast depth (mm)">
            <input type="text" id="shoulder" value="300" placeholder="Ballast shoulder width (mm)">
            <button class="calc-btn" onclick="calculate()" id="calcBtn">Calculate</button>
        </div>
        <div class="results" id="results">
            <div class="result-item" id="ballast"></div>
        </div>
        <div class="bottom-row">
            <button class="spacing-btn" onclick="cycleSpacing()">600mm</button>
            <button class="copy-btn" onclick="copyResults()" id="copyBtn">Copy</button>
        </div>
    </div>

    <!-- Terms Modal -->
    <div id="termsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('termsModal')">&times;</span>
            <h2>Terms of Service</h2>
            <p>Last updated: [15-06-2023]</p>
            <p>Acceptance of Terms<br>By accessing and using the Railapp ("the App"), you are agreeing to be bound by these Terms of Service. If you do not agree to these terms, please do not access or use the App.</p>
            <p>Use of the App<br>The App is designed to assist with railway construction and maintenance. While we strive to provide useful tools such as a rail materials calculator, destress rail calculator, scope checklist, and other railway-related features, you agree to use this App at your own risk. The tools and information provided by this App are intended for general informational purposes only and should not be relied upon as the sole basis for making decisions.</p>
            <p>Disclaimers<br>The App is provided on an "as is" and "as available" basis. We do not warrant the completeness, accuracy, or reliability of any information or data you find on the App. You acknowledge and agree that any reliance on such information is strictly at your own risk. We disclaim all liability for any inaccuracy, error, or incompleteness in the App's content.</p>
            <p>You agree to independently verify any information you obtain from the App before relying on it. You are responsible for your own actions taken based on the information obtained from the App.</p>
            <p>Limitation of Liability<br>In no event will we be liable for any direct, indirect, special, consequential or punitive damages, including without limitation, loss of profits, data, use, goodwill, or other intangible losses, resulting from (i) your access to or use of or inability to access or use the App; (ii) any conduct or content of any third party on the App; (iii) any content obtained from the App; and (iv) unauthorized access, use or alteration of your transmissions or content, whether based on warranty, contract, tort (including negligence) or any other legal theory, whether or not we have been informed of the possibility of such damage.</p>
            <p>Amendments<br>We reserve the right, at our sole discretion, to modify or replace these Terms at any time. It is your responsibility to review these Terms periodically for changes.</p>
            <p>Contact Us<br>If you have any questions about these Terms, please contact us at [your contact details].</p>
            <p>By using Railapp, you acknowledge that you have read and understood these Terms of Service.</p>
            <button class="decline-btn" onclick="declineTerms()">Decline</button>
            <button class="agree-btn" onclick="agreeTerms()">Agree</button>
        </div>
    </div>

    <!-- Quote Modal -->
    <div id="quoteModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('quoteModal')">&times;</span>
            <h2>Quote of the Week</h2>
            <p id="quoteText"></p>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('infoModal')">&times;</span>
            <h2>Info</h2>
            <p>The ballast quantity might be slightly inaccurate depending on the specific requirements of the track section. Press the 600mm button to toggle between spacing options, 600, 650, 670, 675, 700.</p>
        </div>
    </div>

    <script>
        const quotes = [
            "Who places any value on his time, who reckons the worth of each day, who understands that he is dying daily? For we are mistaken when we look forward to death; the major portion of death has already passed. Whatever years be behind us are in death's hands. (Seneca 4BCE - 65 CE)",
            "In the end, it's not the years in your life that count. It's the life in your years. - Abraham Lincoln",
            "The secret of success is to do the common thing uncommonly well. - John D. Rockefeller Jr.",
            "The only place where success comes before work is in the dictionary. - Vidal Sassoon",
            "The first method for estimating the intelligence of a ruler is to look at the men he has around him. - Machiavelli",
            "The happiness of your life depends upon the quality of your thoughts. - Marcus Aurelius",
            "We are not disturbed by what happens to us, but by our thoughts about what happens to us. - Epictetus (50-135 AD)",
            "Wealth is the slave of a wise man and the master of a fool. Seneca"
        ];

        const sleeperSpacingOptions = [0.6, 0.65, 0.670, 0.675, 0.7];
        let selectedSleeperSpacingIndex = 0;
        const agreedToTerms = localStorage.getItem('agreedToTerms') === 'true';
        let resultsCopied = false;

        // Init quote
        const weekOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 1)) / (24 * 60 * 60 * 1000 * 7));
        const quoteIndex = weekOfYear % quotes.length;
        document.getElementById('quoteText').innerText = quotes[quoteIndex];

        // Show terms if not agreed
        if (!agreedToTerms) {
            document.getElementById('termsModal').style.display = 'block';
            document.getElementById('calcBtn').classList.add('disabled');
        }

        function agreeTerms() {
            agreedToTerms = true;
            localStorage.setItem('agreedToTerms', 'true');
            closeModal('termsModal');
            document.getElementById('calcBtn').classList.remove('disabled');
        }

        function declineTerms() {
            // Simulate exit, e.g., close window or hide content
            document.body.innerHTML = '<h1>Terms Declined</h1>';
        }

        function showQuote() {
            document.getElementById('quoteModal').style.display = 'block';
        }

        function showInfo() {
            document.getElementById('infoModal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function cycleSpacing() {
            selectedSleeperSpacingIndex = (selectedSleeperSpacingIndex + 1) % sleeperSpacingOptions.length;
            const btn = document.querySelector('.spacing-btn');
            btn.innerText = `${Math.round(sleeperSpacingOptions[selectedSleeperSpacingIndex] * 1000)}mm`;
            if (document.getElementById('distance').value) {
                calculate();
            }
        }

        function calculate() {
            if (!agreedToTerms) return;
            const distanceStr = document.getElementById('distance').value;
            const depthStr = document.getElementById('depth').value;
            const shoulderStr = document.getElementById('shoulder').value;
            const distance = parseFloat(distanceStr);
            const depth_m = parseFloat(depthStr) / 1000;
            const shoulder_m = parseFloat(shoulderStr) / 1000;
            if (isNaN(distance) || isNaN(depth_m) || isNaN(shoulder_m)) return;

            const spacing = sleeperSpacingOptions[selectedSleeperSpacingIndex];
            const total_width_m = 2.6 + 2 * shoulder_m; // Sleeper length 2600mm = 2.6m
            const cross_area = total_width_m * depth_m;
            const total_vol = distance * cross_area;

            const sleeper_vol_single = 2.6 * 0.3 * 0.3; // Length x width x height in m (2600mm x 300mm x 300mm)
            const num_sleepers = distance / spacing;
            const total_sleeper_vol = num_sleepers * sleeper_vol_single;

            const net_vol = total_vol - total_sleeper_vol;

            // Display results
            document.getElementById('ballast').innerHTML = `*Ballast Volume (Roughly): ${net_vol.toFixed(2)} cubic meters <img src="ballast.png" class="icon" alt="ballast">`; // Replace src with actual

            document.getElementById('results').style.display = 'block';
            resultsCopied = false;
            document.getElementById('copyBtn').classList.remove('disabled');
        }

        function copyResults() {
            if (resultsCopied) return;
            const resultsDiv = document.getElementById('results');
            let text = '';
            for (let child of resultsDiv.children) {
                text += child.innerText + '\n';
            }
            navigator.clipboard.writeText(text);
            resultsCopied = true;
            document.getElementById('copyBtn').classList.add('disabled');
        }
    </script>
</body>
</html>